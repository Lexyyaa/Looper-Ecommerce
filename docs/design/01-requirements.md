# 요구사항 명세서
> 본 문서는 이커머스 기능 구현을 위한 요구사항을 정의한 문서입니다.
주요 시나리오를 기준으로 기능의 동작 조건, 예외 처리을 정리하였습니다.

---
## 사용자
#### 회원가입
> ✅ **Happy Path**
- 사용자는 `로그인ID`, `성별`, `생년월일`, `이메일` 을 모두 입력하여 회원가입을 진행할 수 있다.
- 각 필드는 아래의 규칙을 만족해야 한다.
    - `로그인ID` : 영문/숫자 조합, 최대 10자
    - `성별` : `M` 또는 `F`
    - `생년월일` : `yyyy-mm-dd` 형식
    - `이메일` : `xx@yy.zz` 형식
> 🚨 **Fail Cases**
- 필수 입력 값이 누락될 경우 오류를 반환한다 (400 Bad Request)
- 각 필드가 규칙에 맞지 않으면 오류를 반환한다.  (400 Bad Request)
- 이미 존재하는 ID로 가입 시도할 경우 오류를 반환한다. (409 Conflict)
- 시스템 장애로 회원가입이 실패할 경우 오류를 반환한다. (500 Internel Server Error)

#### 내정보조회
> ✅ **Happy Path**
- 사용자는 `X-USER-ID` 헤더에 본인의 `loginId`를 담아 요청하면 본인 정보를 조회할 수 있다.
- 내 정보 조회시 로그인Id, 성별, 생년월일, 이메일주소, 보유포인트를 확인할 수 있다.
> 🚨 **Fail Cases**
- 존재하지 않는 사용자일 경우 오류를 반환한다. (404 Not Found)
- 시스템 장애로 내정보조회가 실패할 경우 오류를 반환한다. (500 Internel Server Error)
---
## 포인트
#### 포인트 충전(POST /api/v1/points/charge)
> ✅ **Happy Path**
- 사용자는 `충전금액`을 입력하여 포인트를 충전할 수 있다.
- 충전금액은 양의 정수값으로 입력해야한다.
- 충전 후 응답으로 `loginId`, `보유포인트 잔액`을 반환한다
> 🚨 **Fail Cases**
- 존재하지 않는 사용자일 경우 오류를 반환한다. (404 Not Found)
- 요청 금액이 양의 정수가 아닌 경우  오류를 반환한다.(400 Bad Request)
- 시스템 장애로 포인트 충전이 실패할 경우 오류를 반환한다. (500 Internel Server Error)

#### 포인트 조회 (GET /api/v1/points)
> ✅ **Happy Path**
- 사용자는 헤더값 `X-USER-ID` 를 통해 본인 보유포인트를 확인할 수 있다.
> 🚨 **Fail Cases**
- 존재하지 않는 사용자일 경우 오류를 반환한다. (404 Not Found)
- 시스템 장애로 포인트 조회가 실패할 경우 오류를 반환한다. (500 Internel Server Error)

#### 포인트 사용 (POST /api/v1/points/use)
> ✅ **Happy Path**
- 사용자는 결제 시  포인트를 사용할 수 있다.
- 사용 후 응답으로 `loginId`, `보유포인트 잔액`을 반환한다
> 🚨 **Fail Cases**
- 존재하지 않는 사용자일 경우 오류를 반환한다. (404 Not Found)
- 결제 금액이 보유 포인트를 초과하는 경우 오류를 반환한다. (400 Bad Request)
- 시스템 장애로 포인트 사용이 실패할 경우 오류를 반환한다. (500 Internel Server Error)

---
## 브랜드 & 상품
#### 브랜드정보 조회 (GET /api/v1/brands/{brandId})
> ✅ **Happy Path**
- 사용자는 특정 브랜드의 정보를 조회할 수 있다.
- 유효한 `브랜드ID`를 입력하면 `브랜드ID`, `브랜드명`, `설명` 등을 확인할 수 있다.
- 브랜드 상태가 `조회가능` 상태라면 정상적으로 데이터를 확인할 수 있다.
> 🚨 **Fail Cases**
- 존재하지 않는 브랜드를 조회할 경우 오류를 반환한다. (404 Not Found)
- 브랜드 상태가 조회가능 상태가 아닐 경우 오류를 반환한다. (400 Bad Request)
- 시스템 장애로 브랜드정보조회가 실패할 경우 오류를 반환한다. (500 Internel Server Error)

#### 상품 목록 정보 조회 (GET /api/v1/products)
> ✅ **Happy Path**
- 사용자는 `판매중` 상품 목록을 조회할 수 있다.
- 각 상품의 `상품명`, `상품가격`, `좋아요 수`를 확인할 수 있다.
- 상품 목록을 `최신순`, `낮은가격순`, `좋아요순`으로 정렬할 수 있다.
- 상품 목록의 정렬값은 `최신순` 이 디폴트값이다.
- 쿼리 파라미터를 통해 특정 브랜드의 상품만 조회할 수 있다. (e.g. GET /api/v1/products?brandId=1)
- 한 페이지당 상품은 5개씩 조회된다. (page, size 파라미터를 통해 페이징 가능하며 기본값은 size=5)
> 🚨 **Fail Cases**
- 존재하지 않는 브랜드ID로 상품 목록을 요청할 경우 오류를 반환한다. (404 Not Found)
- 존재하지 않는 정렬값이 전달될 경우 오류를 반환한다. (400 Bad Request)
- 시스템 장애로 상품목록조회가 실패할 경우 오류를 반환한다. (500 Internel Server Error)

#### 상품 상세 정보 조회 (GET /api/v1/products/{productid})
> ✅ **Happy Path**
- 사용자는 유효한 `상품ID`를 통해 상품 상세정보(기본정보, 옵션정보)를 조회할 수 있다.
- 상품의 `상품명`, `옵션`, `상품가격`, `좋아요 수` 을 확인할 수 있다.
- 옵션별 재고수량을 확인할 수 있다.
> 🚨 **Fail Cases**
- 존재하지 않는 상품ID로 조회를 요청할 경우 오류를 반환한다. (404 Not Found)
- `판매중`이 아닌 상태의 상품을 요청하면 오류를 반환한다. (400 Bad Request)
- 시스템 장애로 상품 상세정보조회가 실패할 경우 오류를 반환한다. (500 Internel Server Error)
---

## 좋아요
#### 좋아요 등록  (POST /api/v1/products/{productId}/likes )
> ✅ **Happy Path**
- 사용자는 상품에 좋아요를 할 수 있다.
- 사용자는 하나의 상품에 단 한 번만 좋아요를 할 수 있다 (중복 요청 시 무시, 멱등성 유지).
> 🚨 **Fail Cases**
- 존재하지 않는 상품에 대하여 좋아요 요청시 오류를 반환한다. (404 Not Found)
- 존재하지 않는 사용자일 경우 오류를 반환한다. (404 Not Found)
- 시스템 장애로 상품 좋아요 등록이 실패할 경우 오류를 반환한다. (500 Internel Server Error)

#### 좋아요 취소  (DELETE /api/v1/products/{productId}/likes )
> ✅ **Happy Path**
- 사용자는 자신이 좋아요한 상품의 좋아요를 취소할 수 있다.
- 좋아요하지 않은 상품에 대해 취소 요청해도 오류 없이 멱등하게 처리된다.
> 🚨Fail Cases
- 존재하지 않는 상품에 대하여 좋아요 취소요청시 오류를 반환한다. (400 Bad Request)

#### 내가 좋아요한 상품 목록 조회 (GET /api/v1/products/liked-by/{userId})
> ✅ **Happy Path**
- 사용자는 자신이 좋아요한 상품 목록을 조회할 수 있다.
- 각 상품의 `상품명`, `상품가격`, `좋아요 수`를 함께 확인할 수 있다.
- 결과는 `좋아요순`으로 정렬된다.
> 🚨 **Fail Cases**
- 존재하지 않는 사용자일 경우 오류를 반환한다. (404 Not Found)

---
## 주문
#### 주문요청 (POST /api/v1/orders)
> ✅ **Happy Path**
- 사용자가 상품의 `옵션`, `수량`을 선택 후 주문을 진행한다.
- 사용자가 주문 요청시 해당 상품옵션의 재고는 선점된다.
- 모든 판매가능 수량이 선점되었을 경우 해당 상품은 품절상태로 변경한다.
- 주문요청 시 `선택한 상품의 옵션목록`, `주문금액`, `주문일자`을 반환한다.
> 🚨 **Fail Cases**
- 존재하지 않는 상품의 경우 오류를 반환한다.(404 Not Found)
- 선택한 상품의 재고부족시 오류를 반환한다. (400 Bad Request)


#### 주문취소요청  (POST /api/v1/orders/{orderId}/cancellation)
> ✅ **Happy Path**
- 사용자는 결제 완료되지 않은 주문을 취소할 수 있다.
- 주문 취소 시 선점된 재고는 취소된다.
> 🚨 **Fail Cases**
- 존재하지 않는 주문 ID에 대해 요청하면 오류를 반환한다. (404 Not Found)
- 이미 취소된 주문에 대해 다시 요청하면 오류를 반환한다. (409 Conflict)
- 본인의 주문이 아닌 경우 오류를 반환한다. (403 Forbidden)

#### 주문 목록 조회 (GET /api/v1/users/{userId}/orders)
> ✅ **Happy Path**
- 사용자는 자신이 주문한 주문목록을 조회할 수 있다
- 각 주문에는 `주문일`, `금액`, `상태` 가 포함된다.
> 🚨 **Fail Cases**
- 존재하지 않는 사용자에 대한 요청일 경우 오류를 반환한다. (404 Not Found)

#### 단일 주문 조회 (GET / api/v1/orders/{orderId})
> ✅ **Happy Path**
- 사용자는 특정 주문의 상세 정보를 조회할 수 있다.
- 주문의 `상태`, `결제 정보`, `상품 정보` 가 포함된다.
> 🚨 **Fail Cases**
- 존재하지 않는 주문ID로 조회를 요청할 경우 오류를 반환한다. (404 Not Found)
- 시스템 장애로 상품 단일 주문 조회 가 실패할 경우 오류를 반환한다. (500 Internel Server Error)
---
## 결제
#### 결제요청  (POST /api/v1/orders/{orderId}/payments)
> ✅ **Happy Path**
- 사용자는 결제수단을 선택하여 해당 주문건에 대해 결제요청할 수 있다.
- 결제 전 상태의 주문에 대해서만 결제가 가능하다.
- 포인트로 결제요청시 회원의 포인트가 결제금액 만큼 차감된다.
- 포인트로 결제요청시 해당 주문은 완료상태로 변경된다.
> 🚨 **Fail Cases**
- 존재하지 않는 상품의 경우 오류를 반환한다.(404 Not Found)
- 결제금액이 잔여포인트보다 클 경우 오류를 반환한다. (400 Bad Request)
- 결제할 주문의 상태가 "결제 전" 이 아닐 경우 오류를 반환한다. (409 Conflict)

#### 결제취소요청 (DELETE /api/v1/orders/{orderId}/payments/{paymentId})
> ✅ **Happy Path**
- 사용자는 결제 완료된 건에 대해 취소 요청할 수 있다.
- 결제 취소 시 사용된 포인트가 복원된다.
> 🚨 **Fail Cases**
- 존재하지 않는 결제 ID 요청 시 오류를 반환한다. (404 Not Found)
- 존재하지않는 사용자일 경우 오류를 반환한다. (404 Not Found)
- 이미 취소된 결제에 다시 요청하면 오류를 반환한다. (409 Conflict)

 